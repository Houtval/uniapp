"use strict";const e=require("../../../common/vendor.js"),a=require("../../../mqtt/mqtt.js"),m=require("../../../api/index.js"),c={data(){return{showPassword:!0,passwordIcon:"lock",form:{userInfo:{username:"",password:""}},rules:{"userInfo.username":{type:"string",required:!0,message:"请填写用户名",trigger:["blur","change"]},"userInfo.password":{type:"string",required:!0,message:"请填写密码",trigger:["blur","change"]}},radio:"",switchVal:!1}},methods:{submit(){let t=this;this.$refs.uvFormRef.validate().then(n=>{e.index.request({header:{"Content-Type":"application/json"},url:m.apiUrl+"/user/login",method:"POST",data:{username:this.form.userInfo.username,password:this.form.userInfo.password},dataType:"json",success:s=>{s.data.code=="2000"?(e.index.showToast({icon:"success",title:"登录成功"}),e.index.setStorage({key:"username",data:t.form.userInfo.username}),e.index.setStorage({key:"userid",data:s.data.result[0].id}),a.init(),a.publish("/stm32","订阅成功"),a.reception(),setTimeout(function(){e.index.reLaunch({url:"/pages/tabbar/home/home"})},1e3)):e.index.showToast({icon:"success",title:s.data.message})}})})},reset(){this.$refs.uvFormRef.resetFields(),this.$refs.uvFormRef.clearValidate()},register(){e.index.navigateTo({url:"/pages/user/register/register"}),this.$refs.uvFormRef.clearValidate()},hideKeyboard(){e.index.hideKeyboard()},showPasswordMethod(){this.showPassword==!1?(this.passwordIcon="lock",this.showPassword=!0):(this.passwordIcon="lock-open",this.showPassword=!1)}}};if(!Array){const t=e.resolveComponent("uv-input"),n=e.resolveComponent("uv-form-item"),s=e.resolveComponent("uv-icon"),i=e.resolveComponent("uv-button"),o=e.resolveComponent("uv-form");(t+n+s+i+o)()}const p=()=>"../../../uni_modules/uv-input/components/uv-input/uv-input.js",l=()=>"../../../uni_modules/uv-form/components/uv-form-item/uv-form-item.js",d=()=>"../../../uni_modules/uv-icon/components/uv-icon/uv-icon.js",f=()=>"../../../uni_modules/uv-button/components/uv-button/uv-button.js",_=()=>"../../../uni_modules/uv-form/components/uv-form/uv-form.js";Math||(p+l+d+f+_)();function v(t,n,s,i,o,u){return{a:e.o(r=>o.form.userInfo.username=r),b:e.p({placeholder:"请输入用户名",modelValue:o.form.userInfo.username}),c:e.sr("item1","58a866f6-1,58a866f6-0"),d:e.p({label:"用户名",prop:"userInfo.username",borderBottom:!0}),e:e.o(u.showPasswordMethod),f:e.p({name:o.passwordIcon,color:"#black",size:"20"}),g:e.o(r=>o.form.userInfo.password=r),h:e.p({password:o.showPassword,placeholder:"请输入密码",suffixIconStyle:"color: #909399",modelValue:o.form.userInfo.password}),i:e.sr("item1","58a866f6-3,58a866f6-0"),j:e.p({label:"密码",prop:"userInfo.password",borderBottom:!0}),k:e.o(r=>u.submit()),l:e.p({type:"primary",text:"提交",customStyle:"margin-top: 10px"}),m:e.o(r=>u.register()),n:e.p({type:"primary",text:"注册",customStyle:"margin-top: 10px"}),o:e.o(r=>u.reset()),p:e.p({type:"error",text:"重置",customStyle:"margin-top: 10px"}),q:e.sr("uvFormRef","58a866f6-0"),r:e.p({labelPosition:"left",labelWidth:"50px",model:o.form,rules:o.rules})}}const h=e._export_sfc(c,[["render",v],["__scopeId","data-v-58a866f6"],["__file","D:/imformation/uni-app/stm32/pages/user/login/login.vue"]]);wx.createPage(h);
