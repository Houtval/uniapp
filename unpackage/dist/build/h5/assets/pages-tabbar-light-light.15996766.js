import{o as t,g as o,w as e,d as s,j as l,e as r,t as a,k as c,l as i,m as n,p as u,i as h,f as _,c as p,F as g,q as f,u as b}from"./index-07de3841.js";import{_ as d,a as m}from"./uv-row.2798b1fe.js";import{m as v,b as k,a as C,p as y}from"./mqtt.806dc7db.js";import{_ as x,a as w}from"./uv-slider.0b57beee.js";import{a as S}from"./uv-button.241ff25f.js";import{_ as T}from"./_plugin-vue_export-helper.1b428a4d.js";import{_ as $}from"./uv-popup.8273fe42.js";const B=T({name:"uv-toolbar",emits:["confirm","cancel"],mixins:[v,k,{props:{show:{type:Boolean,default:!0},showBorder:{type:Boolean,default:!1},cancelText:{type:String,default:"取消"},confirmText:{type:String,default:"确认"},cancelColor:{type:String,default:"#909193"},confirmColor:{type:String,default:"#3c9cff"},title:{type:String,default:""}}}],methods:{cancel(){this.$emit("cancel")},confirm(){this.$emit("confirm")}}},[["render",function(_,p,g,f,b,d){const m=u,v=h;return _.show?(t(),o(v,{key:0,class:i(["uv-toolbar",{"uv-border-bottom":_.showBorder}]),onTouchmove:n(_.noop,["stop","prevent"])},{default:e((()=>[s(v,{class:"uv-toolbar__cancel__wrapper","hover-class":"uv-hover-class"},{default:e((()=>[s(m,{class:"uv-toolbar__wrapper__cancel",onClick:d.cancel,style:l({color:_.cancelColor})},{default:e((()=>[r(a(_.cancelText),1)])),_:1},8,["onClick","style"])])),_:1}),_.title?(t(),o(m,{key:0,class:"uv-toolbar__title uv-line-1"},{default:e((()=>[r(a(_.title),1)])),_:1})):c("",!0),s(v,{class:"uv-toolbar__confirm__wrapper","hover-class":"uv-hover-class"},{default:e((()=>[s(m,{class:"uv-toolbar__wrapper__confirm",onClick:d.confirm,style:l({color:_.confirmColor})},{default:e((()=>[r(a(_.confirmText),1)])),_:1},8,["onClick","style"])])),_:1})])),_:1},8,["class","onTouchmove"])):c("",!0)}],["__scopeId","data-v-901bbb45"]]);function I(t){let o={},e=t.h,s=255*t.s/100,l=255*t.b/100;if(0==s)o.r=o.g=o.b=l;else{let t=l,r=(255-s)*l/255,a=e%60*(t-r)/60;360==e&&(e=0),e<60?(o.r=t,o.b=r,o.g=r+a):e<120?(o.g=t,o.b=r,o.r=t-a):e<180?(o.g=t,o.r=r,o.b=r+a):e<240?(o.b=t,o.r=r,o.g=t-a):e<300?(o.b=t,o.g=r,o.r=r+a):e<360?(o.r=t,o.g=r,o.b=t-a):(o.r=0,o.g=0,o.b=0)}return{r:Math.round(o.r),g:Math.round(o.g),b:Math.round(o.b)}}function V(t){let o={h:0,s:0,b:0},e=Math.min(t.r,t.g,t.b),s=Math.max(t.r,t.g,t.b),l=s-e;return o.b=s,o.s=0!=s?255*l/s:0,0!=o.s?t.r==s?o.h=(t.g-t.b)/l:t.g==s?o.h=2+(t.b-t.r)/l:o.h=4+(t.r-t.g)/l:o.h=-1,o.h*=60,o.h<0&&(o.h=0),o.s*=100/255,o.b*=100/255,o}const j=[{r:60,g:156,b:255,a:1},{r:245,g:108,b:108,a:1},{r:249,g:174,b:61,a:1},{r:90,g:199,b:37,a:1},{r:144,g:147,b:153,a:1},{r:48,g:49,b:51,a:1},{r:233,g:30,b:99,a:1},{r:156,g:39,b:176,a:1},{r:103,g:58,b:183,a:1},{r:63,g:81,b:181,a:1},{r:0,g:188,b:212,a:1},{r:0,g:150,b:136,a:1},{r:139,g:195,b:74,a:1},{r:205,g:220,b:57,a:1},{r:255,g:235,b:59,a:1},{r:255,g:193,b:7,a:1},{r:255,g:152,b:0,a:1},{r:255,g:87,b:34,a:1},{r:121,g:85,b:72,a:1},{r:158,g:158,b:158,a:1},{r:0,g:0,b:0,a:.5},{r:0,g:0,b:0,a:0}];const M=T({name:"uv-pick-color",emits:["confirm","cancel","close","change"],mixins:[v,k,{props:{color:{type:Object,default:()=>({r:0,g:0,b:0,a:0})},prefabColor:{type:Array,default:()=>[]},closeOnClickOverlay:{type:Boolean,default:!0},title:{type:String,default:""},cancelText:{type:String,default:"取消"},confirmText:{type:String,default:"确定"},cancelColor:{type:String,default:"#909193"},confirmColor:{type:String,default:"#3c9cff"}}}],computed:{pointerStyle(){const t={};return t.top=this.$uv.addUnit(this.site[0].top-8),t.left=this.$uv.addUnit(this.site[0].left-8),t}},data:()=>({showToolbar:!1,rgba:{r:0,g:0,b:0,a:1},hsb:{h:0,s:0,b:0},site:[{top:0,left:0},{left:0},{left:0}],index:0,bgcolor:{r:255,g:0,b:0,a:1},hex:"#000000",mode:!0,colorList:j}),watch:{prefabColor(t){this.colorList=t}},created(){this.rgba=this.color,this.prefabColor.length&&(this.colorList=this.prefabColor)},methods:{open(){this.$refs.pickerColorPopup.open(),this.showToolbar=!0,this.$nextTick((async()=>{await this.$uv.sleep(350),this.getSelectorQuery()}))},close(){this.$refs.pickerColorPopup.close()},popupChange(t){t.show||this.$emit("close")},cancelHandler(){this.$emit("cancel"),this.close()},confirmHandler(){this.$emit("confirm",{rgba:this.rgba,hex:this.hex}),this.close()},init(){this.hsb=V(this.rgba),this.setValue(this.rgba)},async getSelectorQuery(){const t=await this.$uvGetRect(".drag-box",!0);this.position=t,this.setColorBySelect(this.rgba)},select(){this.mode=!this.mode},touchstart(t,o){const{pageX:e,pageY:s}=t.touches[0];this.pageX=e,this.pageY=s,this.setPosition(e,s,o)},touchmove(t,o){const{pageX:e,pageY:s}=t.touches[0];this.moveX=e,this.moveY=s,this.setPosition(e,s,o)},touchend(t,o){},setPosition(t,o,e){this.index=e;const{top:s,left:l,width:r,height:a}=this.position[e];this.site[e].left=Math.max(0,Math.min(parseInt(t-l),r)),0===e?(this.site[e].top=Math.max(0,Math.min(parseInt(o-s),a)),this.hsb.s=parseInt(100*this.site[e].left/r),this.hsb.b=parseInt(100-100*this.site[e].top/a),this.setColor(),this.setValue(this.rgba)):this.setControl(e,this.site[e].left)},setColor(){const t=I(this.hsb);this.rgba.r=t.r,this.rgba.g=t.g,this.rgba.b=t.b},setValue(t){this.hex=`#${function(t){let o=[t.r.toString(16),t.g.toString(16),t.b.toString(16)];return o.map((function(t,e){1==t.length&&(o[e]="0"+t)})),o.join("")}(t)}`},setControl(t,o){const{top:e,left:s,width:l,height:r}=this.position[t];1===t?(this.hsb.h=parseInt(360*o/l),this.bgcolor=I({h:this.hsb.h,s:100,b:100}),this.setColor()):this.rgba.a=+(o/l).toFixed(1),this.setValue(this.rgba)},setColorBySelect(t){const{r:o,g:e,b:s,a:l}=t;let r={};r={r:o?parseInt(o):0,g:e?parseInt(e):0,b:s?parseInt(s):0,a:l||0},this.rgba=r,this.hsb=V(r),this.changeViewByHsb()},changeViewByHsb(){const[t,o,e]=this.position;this.site[0].left=parseInt(this.hsb.s*t.width/100),this.site[0].top=parseInt((100-this.hsb.b)*t.height/100),this.setColor(this.hsb.h),this.setValue(this.rgba),this.bgcolor=I({h:this.hsb.h,s:100,b:100}),this.site[1].left=this.hsb.h/360*o.width,this.site[2].left=this.rgba.a*e.width}}},[["render",function(c,i,b,d,m,v){const k=C(_("uv-toolbar"),B),y=h,x=u,w=C(_("uv-popup"),$);return t(),o(w,{ref:"pickerColorPopup",mode:"bottom","close-on-click-overlay":c.closeOnClickOverlay,onChange:v.popupChange},{default:e((()=>[s(y,{class:"uv-pick-color"},{default:e((()=>[s(k,{show:m.showToolbar,cancelColor:c.cancelColor,confirmColor:c.confirmColor,cancelText:c.cancelText,confirmText:c.confirmText,title:c.title,"show-border":!0,onCancel:v.cancelHandler,onConfirm:v.confirmHandler},null,8,["show","cancelColor","confirmColor","cancelText","confirmText","title","onCancel","onConfirm"]),s(y,{class:"uv-pick-color__box",style:l({background:`rgb(${m.bgcolor.r},${m.bgcolor.g},${m.bgcolor.b})`})},{default:e((()=>[s(y,{class:"uv-pick-color__box__bg drag-box",onClick:i[0]||(i[0]=n((t=>v.touchstart(t,0)),["stop","prevent"])),onTouchstart:i[1]||(i[1]=n((t=>v.touchstart(t,0)),["stop","prevent"])),onTouchmove:i[2]||(i[2]=n((t=>v.touchmove(t,0)),["stop","prevent"])),onTouchend:i[3]||(i[3]=n((t=>v.touchend(t,0)),["stop","prevent"]))},{default:e((()=>[s(y,{class:"uv-pick-color__box__bg-mask"}),s(y,{class:"uv-pick-color__box__bg-pointer",style:l([v.pointerStyle])},null,8,["style"])])),_:1})])),_:1},8,["style"]),s(y,{class:"uv-pick-color__control"},{default:e((()=>[s(y,{class:"uv-pick-color__control__alpha"},{default:e((()=>[s(y,{class:"uv-pick-color__control__alpha--color",style:l({background:`rgba(${m.rgba.r},${m.rgba.g},${m.rgba.b},${m.rgba.a})`})},null,8,["style"])])),_:1}),s(y,{class:"uv-pick-color__control__item"},{default:e((()=>[s(y,{class:"uv-pick-color__control__item__drag drag-box",onClick:i[4]||(i[4]=n((t=>v.touchstart(t,1)),["stop"])),onTouchstart:i[5]||(i[5]=n((t=>v.touchstart(t,1)),["stop"])),onTouchmove:i[6]||(i[6]=n((t=>v.touchmove(t,1)),["stop"])),onTouchend:i[7]||(i[7]=n((t=>v.touchend(t,1)),["stop"]))},{default:e((()=>[s(y,{class:"uv-pick-color__control__item__drag--hue"}),s(y,{class:"uv-pick-color__control__item__drag--circle",style:l({left:c.$uv.getPx(m.site[1].left-10,!0)})},null,8,["style"])])),_:1}),s(y,{class:"uv-pick-color__control__item__drag drag-box",onClick:i[8]||(i[8]=n((t=>v.touchstart(t,2)),["stop"])),onTouchstart:i[9]||(i[9]=n((t=>v.touchstart(t,2)),["stop"])),onTouchmove:i[10]||(i[10]=n((t=>v.touchmove(t,2)),["stop"])),onTouchend:i[11]||(i[11]=n((t=>v.touchend(t,2)),["stop"]))},{default:e((()=>[s(y,{class:"uv-pick-color__control__item__drag--alpha"}),s(y,{class:"uv-pick-color__control__item__drag--circle",style:l({left:c.$uv.getPx(m.site[2].left-10,!0)})},null,8,["style"])])),_:1})])),_:1})])),_:1}),s(y,{class:"uv-pick-color__result"},{default:e((()=>[s(y,{class:"uv-pick-color__result__select","hover-class":"uv-hover-class",onClick:n(v.select,["stop"])},{default:e((()=>[s(x,{class:"text"},{default:e((()=>[r("切换")])),_:1}),s(x,{class:"text"},{default:e((()=>[r("模式")])),_:1})])),_:1},8,["onClick"]),m.mode?(t(),o(y,{key:0,class:"uv-pick-color__result__item"},{default:e((()=>[s(y,{class:"uv-pick-color__result__item--value uv-border"},{default:e((()=>[s(x,null,{default:e((()=>[r(a(m.hex),1)])),_:1})])),_:1}),s(y,{class:"uv-pick-color__result__item--hex"},{default:e((()=>[s(x,null,{default:e((()=>[r("HEX")])),_:1})])),_:1})])),_:1})):(t(),p(g,{key:1},[s(y,{class:"uv-pick-color__result__item"},{default:e((()=>[s(y,{class:"uv-pick-color__result__item--value uv-border"},{default:e((()=>[s(x,null,{default:e((()=>[r(a(m.rgba.r),1)])),_:1})])),_:1}),s(y,{class:"uv-pick-color__result__item--rgba"},{default:e((()=>[s(x,null,{default:e((()=>[r("R")])),_:1})])),_:1})])),_:1}),s(y,{class:"uv-pick-color__result__gap"}),s(y,{class:"uv-pick-color__result__item"},{default:e((()=>[s(y,{class:"uv-pick-color__result__item--value uv-border"},{default:e((()=>[s(x,null,{default:e((()=>[r(a(m.rgba.g),1)])),_:1})])),_:1}),s(y,{class:"uv-pick-color__result__item--rgba"},{default:e((()=>[s(x,null,{default:e((()=>[r("G")])),_:1})])),_:1})])),_:1}),s(y,{class:"uv-pick-color__result__gap"}),s(y,{class:"uv-pick-color__result__item"},{default:e((()=>[s(y,{class:"uv-pick-color__result__item--value uv-border"},{default:e((()=>[s(x,null,{default:e((()=>[r(a(m.rgba.b),1)])),_:1})])),_:1}),s(y,{class:"uv-pick-color__result__item--rgba"},{default:e((()=>[s(x,null,{default:e((()=>[r("B")])),_:1})])),_:1})])),_:1}),s(y,{class:"uv-pick-color__result__gap"}),s(y,{class:"uv-pick-color__result__item"},{default:e((()=>[s(y,{class:"uv-pick-color__result__item--value uv-border"},{default:e((()=>[s(x,null,{default:e((()=>[r(a(m.rgba.a),1)])),_:1})])),_:1}),s(y,{class:"uv-pick-color__result__item--rgba"},{default:e((()=>[s(x,null,{default:e((()=>[r("A")])),_:1})])),_:1})])),_:1})],64))])),_:1}),s(y,{class:"uv-pick-color__prefab"},{default:e((()=>[(t(!0),p(g,null,f(m.colorList,((r,a)=>(t(),o(y,{class:"uv-pick-color__prefab__item",key:a},{default:e((()=>[s(y,{class:"uv-pick-color__prefab__item--color",style:l({background:`rgba(${r.r},${r.g},${r.b},${r.a})`}),onClick:n((t=>v.setColorBySelect(r)),["stop"])},null,8,["style","onClick"])])),_:2},1024)))),128))])),_:1})])),_:1})])),_:1},8,["close-on-click-overlay","onChange"])}],["__scopeId","data-v-dbc3b195"]]);const H=T({data:()=>({lightSwitch:!1,lightBrightness:0,color:"#000000",timer:null}),onShow(){this.getStatus()},onHide(){clearInterval(this.timer)},methods:{openColor:function(){this.$refs.pickerColor.open()},confirm:function(t){this.color=t.hex,console.log("confirm",t.hex),y("/stm32","color:"+this.color)},changeSwitch:function(){y("/stm32","lightswitch:"+this.lightSwitch)},changeLightBrightness:function(){y("/stm32","lightbrightness:"+this.lightBrightness)},getStatus:function(){const t=this;t.timer=setInterval((function(){b({key:"lightswitch",success:function(o){t.lightSwitch="true"==o.data}}),b({key:"lightbrightness",success:function(o){t.lightBrightness=o.data}}),b({key:"color",success:function(o){t.color=o.data}})}),3e3)}}},[["render",function(l,c,i,n,p,g){const f=u,b=C(_("uv-col"),d),v=C(_("uv-switch"),x),k=C(_("uv-row"),m),y=C(_("uv-slider"),w),T=C(_("uv-button"),S),$=C(_("uv-pick-color"),M),B=h;return t(),o(B,{class:"content"},{default:e((()=>[s(k,{customStyle:"margin-bottom: 10px"},{default:e((()=>[s(b,{span:"3",offset:"1"},{default:e((()=>[s(f,{class:"text"},{default:e((()=>[r("开关")])),_:1})])),_:1}),s(b,{span:"8"},{default:e((()=>[s(v,{onChange:g.changeSwitch,modelValue:p.lightSwitch,"onUpdate:modelValue":c[0]||(c[0]=t=>p.lightSwitch=t),size:"30"},null,8,["onChange","modelValue"])])),_:1})])),_:1}),s(k,{customStyle:"margin-bottom: 10px"},{default:e((()=>[s(b,{span:"3",offset:"1"},{default:e((()=>[s(f,{class:"text"},{default:e((()=>[r("亮度")])),_:1})])),_:1}),s(b,{span:"8"},{default:e((()=>[s(y,{modelValue:p.lightBrightness,"onUpdate:modelValue":c[1]||(c[1]=t=>p.lightBrightness=t),onChange:g.changeLightBrightness,"block-size":"28",min:"0",max:"100","block-color":"#1296db",showValue:""},null,8,["modelValue","onChange"])])),_:1})])),_:1}),s(k,{customStyle:"margin-bottom: 10px"},{default:e((()=>[s(b,{span:"3",offset:"1"},{default:e((()=>[s(f,{class:"text"},{default:e((()=>[r("颜色")])),_:1})])),_:1}),s(b,{span:"4"},{default:e((()=>[s(T,{type:"primary",text:"打开颜色选择器",onClick:g.openColor},null,8,["onClick"]),s($,{ref:"pickerColor",onConfirm:g.confirm},null,8,["onConfirm"])])),_:1}),s(b,{span:"3",offset:"1"},{default:e((()=>[r(a(p.color),1)])),_:1})])),_:1})])),_:1})}],["__scopeId","data-v-fdbcbcae"]]);export{H as default};
